@using Aspire.Dashboard.Components.Controls.Chart
@using Aspire.Dashboard.Model
@using Aspire.Dashboard.Model.Otlp
@using Aspire.Dashboard.Resources
@using Aspire.Dashboard.Utils
@using Aspire.Dashboard.Extensions
@using System.Globalization

@inject IStringLocalizer<Dialogs> Loc

<FluentDataGrid Items="@MetricView"
                ItemSize="46"
                Virtualize="true"
                GridTemplateColumns="1fr 1fr 1fr"
                TGridItem="Exemplar">
    <ChildContent>
        <TemplateColumn Title="Trace">
            <span style="padding-left:5px; border-left-width: 5px; border-left-style: solid; border-left-color: @(ColorGenerator.Instance.GetColorHexByKey(GetResourceName(context.Application)));">
                @GetResourceName(context.Application)
            </span>
        </TemplateColumn>
        <TemplateColumn Title="@Loc[nameof(ControlsStrings.MetricTableStartColumnHeader)]" TooltipText="@(context => FormatHelpers.FormatDateTime(TimeProvider, TimeProvider.ToLocal(context.Start), MillisecondsDisplay.None, CultureInfo.CurrentCulture))" Tooltip="true">
            @FormatHelpers.FormatTimeWithOptionalDate(TimeProvider, TimeProvider.ToLocal(context.Start))
        </TemplateColumn>
        <TemplateColumn Title="Value">
            @context.Value
        </TemplateColumn>
        <TemplateColumn Title="Details">
            <FluentButton Appearance="Appearance.Lightweight" OnClick="@(() => OnShowPropertiesAsync(context, id))">View</FluentButton>
        </TemplateColumn>
    </ChildContent>
    <EmptyContent>
        <FluentIcon Icon="Icons.Regular.Size24.ChartMultiple" />&nbsp;@Loc[nameof(ControlsStrings.MetricTableNoMetricsFound)]
    </EmptyContent>
</FluentDataGrid>
